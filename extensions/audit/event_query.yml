---
# Networks
cisco.meraki.networks_info:
  query: >-
    .meraki_response | [.] | flatten |
     map({
        name: .name,
        canonical_facts: {
          ansible_meraki_network_id: .id,
          ansible_meraki_org_id: .organizationId
        },
        facts: {
          device_type: "network"
        }
      })
    | .[]

# delete operation returns "meraki_response": null
cisco.meraki.networks:
  query: >-
    if .meraki_response then 
      .meraki_response | 
      {
        name: .name,
        canonical_facts: {
          ansible_meraki_network_id: .id,
          ansible_meraki_org_id: .organizationId
        },
        facts: {
            device_type: "network"
        }
      }
    else empty
    end
